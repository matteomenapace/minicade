<!DOCTYPE html>
<meta charset="utf-8">
<link rel="stylesheet" href="/vendor/fancy-friday.css">
<link rel="stylesheet" href="/css/base.css">
<style>
html body {
  background: white;
}

#minigame-carousel .carousel-control {
  background-image: none;
}

@media (max-width: 340px) {
  #minigame-carousel .carousel-inner .col-sm-4.col-sm-offset-2 {
    display: none;
  }
}

@media (max-width: 768px) {
  #minigame-carousel .iframe-thumbnail-frame {
    display: inline-block;
  }

  #minigame-carousel .carousel-inner {
    text-align: center;
  }

  #minigame-carousel .carousel-inner .col-sm-4 {
    margin-left: 90px;
    margin-right: 90px;
  }
}
</style>
<title>Minigame Example Carousel</title>
<section>
  <div class="container">
    <h1>Minigame Example Carousel</h1>
    <p>Here are some example minigames.</p>
    <div id="minigame-carousel" class="carousel slide" data-ride="carousel">
      <div class="carousel-inner">
        <div class="item active row">
          <div class="col-sm-4 col-sm-offset-2">
            <div class="iframe-thumbnail-frame">
              <div class="iframe-thumbnail-holder" data-loop-microgame="http://jsbin.com/laduqike/3"></div>
            </div>
          </div>
          <div class="col-sm-4">
            <h3>Flyswat</h3>
            <p>By <a href="http://twitter.com/varelidi">@varelidi</a> and <a href="http://twitter.com/toolness">@toolness</a></p>
            <a href="http://jsbin.com/laduqike/3/edit" target="_blank" class="btn btn-awsm btn-awsmblue btn-xs">Remix in JS Bin</a>
          </div>
        </div>

        <div class="item row">
          <div class="col-sm-4 col-sm-offset-2">
            <div class="iframe-thumbnail-frame">
              <div class="iframe-thumbnail-holder" data-loop-microgame="https://mmmo.makes.org/thimble/MTEwMzg4ODM4NA==/text-colour_"></div>
            </div>
          </div>
          <div class="col-sm-4">
            <h3>Text Colour</h3>
            <p>By <a href="https://twitter.com/ohmmmavis">@ohmmmavis</a></p>
            <a href="https://mmmo.makes.org/thimble/MTEwMzg4ODM4NA==/text-colour/remix" target="_blank" class="btn btn-awsm btn-awsmblue btn-xs">Remix in Thimble</a>
          </div>
        </div>

        <div class="item row">
          <div class="col-sm-4 col-sm-offset-2">
            <div class="iframe-thumbnail-frame">
              <div class="iframe-thumbnail-holder" data-loop-microgame="https://stenington.makes.org/thimble/LTE1OTU2NzA1Mjg=/poundsplat_"></div>
            </div>
          </div>
          <div class="col-sm-4">
            <h3>Poundsplat</h3>
            <p>By <a href="http://twitter.com/stenington">@stenington</a></p>
            <a href="https://stenington.makes.org/thimble/LTE1OTU2NzA1Mjg=/poundsplat/remix" target="_blank" class="btn btn-awsm btn-awsmblue btn-xs">Remix in Thimble</a>
        </div>
      </div>
    </div>

    <a class="left carousel-control" href="#minigame-carousel" data-slide="prev">
      <span class="glyphicon glyphicon-chevron-left"></span>
    </a>
    <a class="right carousel-control" href="#minigame-carousel" data-slide="next">
      <span class="glyphicon glyphicon-chevron-right"></span>
    </a>
  </div>
</section>
<script src="/vendor/jquery-2.0.3.js"></script>
<script src="/vendor/bootstrap/js/bootstrap.js"></script>
<script src="/vendor/fancy-friday.js"></script>
<script>
$(function() {
  var PLAY_TIME = 5;
  var DELAY_BEFORE_RESTART_MS = 10000;
  var cacheBust = Date.now();

  function loopMicrogame(el, url) {
    var microgame = FancyFriday.Microgame(url, {
      autoplay: true,
      difficulty: 'medium',
      playTime: PLAY_TIME,
      cacheBust: cacheBust
    });
    var restartTimeout = null;
    var restart = function() {
      if (restartTimeout !== null) clearTimeout(restartTimeout);
      restartTimeout = null;
      el.removeEventListener('click', restart, false);
      el.removeChild(microgame);
      loopMicrogame(el, url);
    };

    microgame.addEventListener("microgameended", function() {
      restartTimeout = setTimeout(restart, DELAY_BEFORE_RESTART_MS);
      el.addEventListener('click', restart, false);
    });
    el.appendChild(microgame);
  }

  $('[data-loop-microgame]').each(function() {
    loopMicrogame(this, $(this).attr('data-loop-microgame'));
  });
});
</script>
